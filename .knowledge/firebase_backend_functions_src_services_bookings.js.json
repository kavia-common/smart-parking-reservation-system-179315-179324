{"is_source_file": true, "format": "JavaScript", "description": "This file defines the BookingsService class, which provides methods to handle parking slot reservations, cancellations, check-ins, completions, and listing user bookings within a Firebase Firestore backend. It manages booking transactions, slot availability, and QR token generation/verification.", "external_files": ["../config/firebase", "../utils/crypto"], "external_methods": ["db.collection", "db.runTransaction", "tx.get", "tx.update", "tx.set", "createQrToken", "verifyQrToken", "FieldValue.increment"], "published": ["BookingsService"], "classes": [{"name": "BookingsService", "description": "A service class providing methods to reserve, cancel, check in, complete booking, and list bookings for users in a parking reservation system."}], "methods": [{"name": "reserve({ userId, lotId, slotId, startTime, endTime, price, currency })", "description": "Reserves a parking slot for a user by creating a booking, marking the slot unavailable, and generating a QR token.", "scope": "BookingsService", "scopeKind": "class"}, {"name": "cancel({ userId, bookingId })", "description": "Cancels an existing booking, marks the slot available, and updates the booking status.", "scope": "BookingsService", "scopeKind": "class"}, {"name": "checkIn({ qrToken })", "description": "Validates a QR token and marks the associated booking as in progress.", "scope": "BookingsService", "scopeKind": "class"}, {"name": "complete({ bookingId })", "description": "Marks a booking as completed and frees the slot.", "scope": "BookingsService", "scopeKind": "class"}, {"name": "listUserBookings({ userId, status, limit = 20 })", "description": "Retrieves recent bookings for a user, optionally filtered by status.", "scope": "BookingsService", "scopeKind": "class"}], "calls": ["db.collection", "db.runTransaction", "tx.get", "tx.update", "tx.set", "createQrToken", "verifyQrToken", "FieldValue.increment"], "search-terms": ["BookingsService", "reserve", "cancel", "checkIn", "complete", "listUserBookings", "firebase", "firestore", "QR token", "parking reservation", "slot availability"], "state": 2, "file_id": 21, "knowledge_revision": 47, "git_revision": "", "ctags": [{"_type": "tag", "name": "BookingsService", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^class BookingsService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "cancel", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^  async cancel({ userId, bookingId }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ userId, bookingId })", "scope": "BookingsService", "scopeKind": "class"}, {"_type": "tag", "name": "checkIn", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^  async checkIn({ qrToken }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ qrToken })", "scope": "BookingsService", "scopeKind": "class"}, {"_type": "tag", "name": "complete", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^  async complete({ bookingId }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ bookingId })", "scope": "BookingsService", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^module.exports = new BookingsService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "listUserBookings", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^  async listUserBookings({ userId, status, limit = 20 }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ userId, status, limit = 20 })", "scope": "BookingsService", "scopeKind": "class"}, {"_type": "tag", "name": "reserve", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/services/bookings.js", "pattern": "/^  async reserve({ userId, lotId, slotId, startTime, endTime, price, currency }) {$/", "language": "JavaScript", "kind": "method", "signature": "({ userId, lotId, slotId, startTime, endTime, price, currency })", "scope": "BookingsService", "scopeKind": "class"}], "hash": "88a412166119047053d1362a20dc4667", "format-version": 4, "code-base-name": "firebase_backend_functions", "filename": "firebase_backend_functions/src/services/bookings.js", "fields": [{"name": "module.exports = new BookingsService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"47": ""}]}