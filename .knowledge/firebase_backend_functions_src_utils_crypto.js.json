{"is_source_file": true, "format": "JavaScript", "description": "This file provides utility functions for creating and verifying HMAC-based QR tokens using SHA-256. It handles serialization of payloads, signature creation, and validation, emphasizing security best practices like environment variables for secrets.", "external_files": ["crypto"], "external_methods": ["crypto.createHmac", "crypto.timingSafeEqual"], "published": ["createQrToken", "verifyQrToken"], "classes": [], "methods": [{"name": "createQrToken(payload)", "description": "Creates a compact HMAC-SHA256 token for QR code payloads, encoding the payload into base64 and appending a hex signature. Uses HMAC_SECRET environment variable for secret key.", "scope": "", "scopeKind": ""}, {"name": "verifyQrToken(token)", "description": "Verifies a token by recomputing the HMAC and comparing securely. Returns validity status and payload if valid, with detailed reasons on failure.", "scope": "", "scopeKind": ""}], "calls": ["process.env.HMAC_SECRET", "crypto.createHmac", "Buffer.from", "JSON.stringify", "JSON.parse", "crypto.timingSafeEqual"], "search-terms": ["HMAC", "QR token", "crypto", "HMAC_SECRET", "base64url", "verify", "createQrToken"], "state": 2, "file_id": 16, "knowledge_revision": 36, "git_revision": "", "ctags": [{"_type": "tag", "name": "createQrToken", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/utils/crypto.js", "pattern": "/^  createQrToken,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "createQrToken", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/utils/crypto.js", "pattern": "/^function createQrToken(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "crypto", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/utils/crypto.js", "pattern": "/^const crypto = require('crypto');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "verifyQrToken", "path": "/home/kavia/workspace/code-generation/smart-parking-reservation-system-179315-179324/firebase_backend_functions/src/utils/crypto.js", "pattern": "/^function verifyQrToken(token) {$/", "language": "JavaScript", "kind": "function", "signature": "(token)"}], "hash": "98aa8f3ee537e6c7c3e86374242c21b8", "format-version": 4, "code-base-name": "firebase_backend_functions", "filename": "firebase_backend_functions/src/utils/crypto.js", "fields": [{"name": "createQrToken,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"36": ""}]}